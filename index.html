<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" type="text/css" href="css/indexStyle.css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        
        <script>
            // get
            $(document).ready(function(){
                $.ajax({
                    url : 'http://localhost:8080/Ubots/Projeto/filmes.json',
                    type : 'GET',
                    success : function(result) {
                        $.each(result, function() {
                            $.each(this, function(i, filme) {
                                $('<tr>').append(
                                    $('<td>').text(filme.id),
                                    $('<td>').text(filme.nome_filme),
                                    $('<td>').text(filme.created),
                                    $('<td>').text(filme.modified),
                                    $('<td>').text(filme.nota_filme),
                                    $('<td>').text(filme.visualizado),
                                    $('<td>').append("<a class='btn btn-default' href='main.html'><em class='fa fa-pencil'></em></a>")
                                    .append("<a class='btn btn-default' href='main.html'><em class='fa fa-trash'></em></a>"),
                                ).appendTo('#records_table');
                            });
                        });
                    }                    
                });
            });
            
            // post
            $(document).ready(function(){
                $("#mainbutton").click(function(){
                    var nomeFilme=$('#nomeFilme').val();
                    var notaFilme=$('#notaFilme').val();
                    var filmeVisualizado=$('#filmeVisualizado').val();

                    $.ajax({
                        url: 'http://localhost:8080/Ubots/Projeto/filmes/add.json',
                        type: 'POST',
                        data: { 
                            nome_filme : nomeFilme,
                            nota_filme : notaFilme,
                            visualizado : filmeVisualizado
                        },
                        success: function(result){
                            console.log(result);
                        }
                    });
                });
            });
            
            //put, edit
            $(document).ready(function(){
                $("#editbutton").click(function(){
                    var idFilme=$('#idFilme').val();
                    var editaNome=$('#editaNome').val();
                    var editaNota=$('#editaNota').val();
                    var editaVisualizacao=$('#editaVisualizacao').val();

                    $.ajax({
                        url : 'http://localhost:8080/Ubots/Projeto/filmes/edit/' + idFilme + '.json',
                        type : 'PUT',
                        data: { 
                            nome_filme : editaNome,
                            nota_filme : editaNota,
                            visualizado : editaVisualizacao
                        },
                        'success' : function(result) {
                        console.log(result);
                        }
                    });
                });
            });
        </script>
    </head>
    <body>
        <table id="records_table">
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Criado</th> 
                <th>Modificado</th> 
                <th>Nota</th>
                <th>Visualizado</th> 
                <th> 
                    <a class="button btn-default" href="main.html"><em class="fa fa-plus-circle"></em></a>
                    <em class="fa fa-cog"></em>
                </th>
            </tr>
        </table>

        <div id="div1">
            <h2>Enviar</h2>
            Nome Filme: <input type="text" id="nomeFilme"><br>
            Nota do Filme: <input type="text" id="notaFilme"><br>
            Filme Visualizado: <input type="text" id="filmeVisualizado"><br>
            <input id="mainbutton" class="mainbutton" type="button" value="Adicionar"/>
        </div> 
        

        <div id="div2">
            <h2>Enviar</h2>
            ID: <input type="text" id="idFilme"><br>
            Novo Nome: <input type="text" id="editaNome"><br>
            Nova  Nota: <input type="text" id="editaNota"><br>
            Filme Visualizado: <input type="text" id="editaVisualizacao"><br>
        </div> 
        <input id="editbutton" class="editbutton" type="button" value="Adicionar"/>
    </body>
</html>
